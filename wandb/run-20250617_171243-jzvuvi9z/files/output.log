Epoch 1/20 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████| 8/8 [00:16<00:00,  2.01s/it, loss=0.779]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:03<00:00,  1.86s/it]
Saved checkpoint: checkpoints/guardian_llm_epoch_0_loss_0.7758.pt
Epoch 2/20 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████| 8/8 [00:30<00:00,  3.79s/it, loss=0.783]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:03<00:00,  1.97s/it]
Saved checkpoint: checkpoints/guardian_llm_epoch_1_loss_0.7749.pt
Epoch 3/20 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████| 8/8 [00:16<00:00,  2.00s/it, loss=0.771]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:04<00:00,  2.22s/it]
Saved checkpoint: checkpoints/guardian_llm_epoch_2_loss_0.7738.pt
Epoch 4/20 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████| 8/8 [00:17<00:00,  2.15s/it, loss=0.765]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:03<00:00,  1.94s/it]
Saved checkpoint: checkpoints/guardian_llm_epoch_3_loss_0.7726.pt
Epoch 5/20 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████| 8/8 [00:15<00:00,  1.97s/it, loss=0.784]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:03<00:00,  1.98s/it]
Saved checkpoint: checkpoints/guardian_llm_epoch_4_loss_0.7713.pt
Epoch 6/20 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████| 8/8 [00:16<00:00,  2.04s/it, loss=0.763]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:03<00:00,  1.87s/it]
Saved checkpoint: checkpoints/guardian_llm_epoch_5_loss_0.7698.pt
Epoch 7/20 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████| 8/8 [00:17<00:00,  2.18s/it, loss=0.771]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:03<00:00,  1.98s/it]
Saved checkpoint: checkpoints/guardian_llm_epoch_6_loss_0.7681.pt
Epoch 8/20 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████| 8/8 [00:16<00:00,  2.05s/it, loss=0.766]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:03<00:00,  1.88s/it]
Saved checkpoint: checkpoints/guardian_llm_epoch_7_loss_0.7663.pt
Epoch 9/20 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████| 8/8 [00:16<00:00,  2.03s/it, loss=0.769]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:03<00:00,  1.98s/it]
Saved checkpoint: checkpoints/guardian_llm_epoch_8_loss_0.7643.pt
Epoch 10/20 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████| 8/8 [00:16<00:00,  2.12s/it, loss=0.75]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:03<00:00,  1.88s/it]
Saved checkpoint: checkpoints/guardian_llm_epoch_9_loss_0.7622.pt
Epoch 11/20 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████| 8/8 [00:16<00:00,  2.03s/it, loss=0.767]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:05<00:00,  2.55s/it]
Saved checkpoint: checkpoints/guardian_llm_epoch_10_loss_0.7601.pt
Epoch 12/20 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████| 8/8 [00:16<00:00,  2.02s/it, loss=0.77]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:03<00:00,  1.87s/it]
Saved checkpoint: checkpoints/guardian_llm_epoch_11_loss_0.7581.pt
Epoch 13/20 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████| 8/8 [00:17<00:00,  2.18s/it, loss=0.755]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:03<00:00,  1.90s/it]
Saved checkpoint: checkpoints/guardian_llm_epoch_12_loss_0.7563.pt
Epoch 14/20 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████| 8/8 [00:16<00:00,  2.03s/it, loss=0.755]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:03<00:00,  1.88s/it]
Saved checkpoint: checkpoints/guardian_llm_epoch_13_loss_0.7548.pt
Epoch 15/20 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████| 8/8 [00:16<00:00,  2.07s/it, loss=0.753]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:03<00:00,  1.92s/it]
Saved checkpoint: checkpoints/guardian_llm_epoch_14_loss_0.7536.pt
Epoch 16/20 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████| 8/8 [00:16<00:00,  2.06s/it, loss=0.772]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:03<00:00,  1.89s/it]
Saved checkpoint: checkpoints/guardian_llm_epoch_15_loss_0.7527.pt
Epoch 17/20 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████| 8/8 [00:16<00:00,  2.05s/it, loss=0.761]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:03<00:00,  1.92s/it]
Saved checkpoint: checkpoints/guardian_llm_epoch_16_loss_0.7521.pt
Epoch 18/20 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████| 8/8 [00:16<00:00,  2.04s/it, loss=0.745]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:04<00:00,  2.05s/it]
Saved checkpoint: checkpoints/guardian_llm_epoch_17_loss_0.7516.pt
Epoch 19/20 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████| 8/8 [00:16<00:00,  2.05s/it, loss=0.757]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:03<00:00,  1.88s/it]
Saved checkpoint: checkpoints/guardian_llm_epoch_18_loss_0.7514.pt
Epoch 20/20 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████| 8/8 [00:17<00:00,  2.15s/it, loss=0.755]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:03<00:00,  1.93s/it]
Saved checkpoint: checkpoints/guardian_llm_epoch_19_loss_0.7513.pt

3. Evaluating model performance...
Traceback (most recent call last):
  File "/Users/prashishshrestha/Desktop/Assignment_3_Major_Project/guardian_llm/backend/scripts/train_all_models.py", line 314, in <module>
    main()
    ~~~~^^
  File "/Users/prashishshrestha/Desktop/Assignment_3_Major_Project/guardian_llm/backend/scripts/train_all_models.py", line 281, in main
    test_results = evaluate_model(trained_model, test_papers, evaluator, tokenizer, trainer)
  File "/Users/prashishshrestha/Desktop/Assignment_3_Major_Project/guardian_llm/backend/scripts/train_all_models.py", line 143, in evaluate_model
    raise ValueError(f"Model returned dict but couldn't find output tensor. Keys: {outputs.keys()}")
ValueError: Model returned dict but couldn't find output tensor. Keys: dict_keys(['risk_0', 'risk_1', 'risk_2', 'risk_3', 'risk_4', 'risk_5'])
